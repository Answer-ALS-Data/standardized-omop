I want to turn the input table into an OMOP table with the indicated fields. 
The name of the script will be <source_table>--<target_table>.py in lowercase
Include a logging file
The source_table is the name of the table in source_tables, but with .csv at the end.
The target table is the first part of the sheet name in caps, it should be saved the same as the script as .csv in lowercase, in the omop_tables folder
[] indicates data type, where [relative days] is days since the initial visit, and [integer option] is an integer that represents certain string values.
<> indicates putting the value of the variable directly into the final table
<<>> indicates using the value of the variable as an input to some function (named <source_table>_<source_variable>_to_<target_table>_<target_variable>) to fill the target table. 
	In most cases, this function is as simple as converting from the integer option to the corresponding _meaning column value. Notice that the source_meaning (often corresponding to _source_value) and target_meaning (often corrsponding to _concept_name) might be different
	In others it is using a relative day and index date to create a new date (index + relative_day). 
	There may be other functions that require some reasoning from context in the sheet to define
<<<>>> indicates using another sheet to fill the values for this source-target pair
/ alone indicates empty on purpose, and that it applies to all entries in the target table
A target_value with no brackets indicates to enter the literal text shown
Any _concept_id should have a corresponding _concept_name next to it corresponding to it's textual meaning (usually in it's target_meaning_ column)
if by the end, a target row have no concept_id it should be filled with code 0 with name No Matching Concept

Here is table can you create the ETL code for this? I would like this general logic to apply to any other set of source-target tables:

use: from helpers import relative_day_to_date, check_missing_concept_ids, get_visit_occurrence_id

Final column order: person_id	observation_concept_id	observation_concept_name	observation_source_value	observation_date	observation_type_concept_id	value_as_number	value_as_string	value_as_concept_id	value_as_concept_name	value_source_value	qualifier_concept_id	qualifier_concept_name	qualifier_source_value	unit_concept_id	unit_concept_name	unit_source_value	visit_occurrence_id	observation_event_id	obs_event_field_concept_id
person_id = <Participant_ID>
observation_start_date = relative_day_to_date(<alsdxdt>, index_date)
_type = 32851  (this is Healthcare professional filled survey)
if value, qualifier, unit (concept id/name) not used then leave these blank.

aalsdxfx-observation
target_row_group	source_table	source_variable_1	source_value_1	source_meaning_1	source_variable_2	source_value_2	source_meaning_2	source_variable_3	source_value_3	source_meaning_3	source_variable_4	source_value_4	source_meaning_4	source_variable_5	source_value_5	source_meaning_5	target_variable_1	target_value_1	target_meaning_1	target_variable_2	target_value_2	target_meaning_2	target_variable_3	target_value_3	target_meaning_3	target_variable_4	target_value_4	target_meaning_4	target_variable_5	target_value_5	target_meaning_5	target_variable_6	target_value_6	target_meaning_6	target_variable_7	target_value_7	target_meaning_7	Notes
	AALSDXFX	alsdx1	[interger option]	Presence of evidence of lower motor neuron (LMN) degeneration by clinical, electrophysiological or neuropathologic examination	alsdxdt	[relative day]											observation_concept_id	als_diagnosis_presence_lmn	Presence of evidence of lower motor neuron (LMN) degeneration by clinical, electrophysiological or neuropathologic examination	observation_source_value	Topographical location and pattern of progression of UMN and LMN signs, including signs of spread within a region or to other regions, consistent with ALS?		value_as_concept_id	<<alsdx1>>	yes (45877994), no (45878245)	value_source_value	<<alsdx1>>	Yes, No	observation_date	{alsdxdt}								
	AALSDXFX	alsdx1	[interger option]	Presence of evidence of upper motor neuron (UMN) degeneration by clinical examination	alsdxdt	[relative day]											observation_concept_id	als_diagnosis_presence_umn	Presence of evidence of upper motor neuron (UMN) degeneration by clinical examination	observation_source_value	Topographical location and pattern of progression of UMN and LMN signs, including signs of spread within a region or to other regions, consistent with ALS?		value_as_concept_id	<<alsdx1>>	yes (45877994), no (45878245)	value_source_value	<<alsdx1>>	Yes, No	observation_date	{alsdxdt}								
	AALSDXFX	alsdx1	[interger option]	Presence of progressive spread of symptoms or signs within a region or to other regions as determined by history or examination	alsdxdt	[relative day]											observation_concept_id	2000000020	Presence of progressive spread of symptoms or signs within a region or to other regions as determined by history or examination	observation_source_value	Topographical location and pattern of progression of UMN and LMN signs, including signs of spread within a region or to other regions, consistent with ALS?		value_as_concept_id	<<alsdx1>>	yes (45877994), no (45878245)	value_source_value	<<alsdx1>>	Yes, No	observation_date	{alsdxdt}								
	AALSDXFX	alsdx2	[interger option]	Absence of electrophysiological or pathological evidence of other disease processes that might explain the signs of LMN and/or UMN degeneration	alsdxdt	[relative day]											observation_concept_id	2000000021	Absence of electrophysiological or pathological evidence of other disease processes that might explain the signs of LMN and/or UMN degeneration	observation_source_value	Exclusion by electrophysiological testing of all other processes including conduction block that might explain the underlying signs and symptoms? 		value_as_concept_id	<<alsdx2>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<alsdx2>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	alsdx3	[interger option]	Absence of neuroimaging evidence of other disease processes that might explain the observed clinical and electrophysiological signs	alsdxdt	[relative day]											observation_concept_id	2000000022	Absence of neuroimaging evidence of other disease processes that might explain the observed clinical and electrophysiological signs	observation_source_value	Exclusion by neuroimaging of other disease processes such as myelopathy or radiculopathy that might explain observed clinical and electrophysiological signs? 		value_as_concept_id	<<alsdx3>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<alsdx3>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	elescrlr	[interger option]	El Escorial criteria - revised	alsdxdt	[relative day]											observation_concept_id	2000000061	El Escorial criteria - revised	observation_source_value	Revised El Escorial Criteria for ALS		value_as_concept_id	<<elescrlr>>	Suspected (2000000062), Possible (2000000058), Probable Laboratory Supported (2000000060), Probable (2000000059), Definite (2000000057)	value_source_value	<<elescrlr>>	Suspected, Possible, Probable Laboratory Supported, Probable, Definite	observation_date	{alsdxdt}								
	AALSDXFX	blbcumn	[interger option]	Bulbar upper motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	2000000035	Bulbar upper motor neuron clinical indicator	observation_source_value	Bulbar upper motor neuron clinical indicator		value_as_concept_id	<<blbcumn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<blbcumn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	luecumn	[interger option]	Left upper extremity upper motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	lueumnclinind	Left upper extremity upper motor neuron clinical indicator	observation_source_value	Left upper extremity upper motor neuron clinical indicator		value_as_concept_id	<<luecumn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<luecumn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	ruecumn	[interger option]	Right upper extremity upper motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	rueumnclinind	Right upper extremity upper motor neuron clinical indicator	observation_source_value	Right upper extremity upper motor neuron clinical indicator		value_as_concept_id	<<ruecumn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<ruecumn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	trnkcumn	[interger option]	Trunk upper motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	trunkumnclinind	Trunk upper motor neuron clinical indicator	observation_source_value	Trunk upper motor neuron clinical indicator		value_as_concept_id	<<trnkcumn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<trnkcumn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	llecumn	[interger option]	Left lower extremity upper motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	lleumnclinind	Left lower extremity upper motor neuron clinical indicator	observation_source_value	Left lower extremity upper motor neuron clinical indicator		value_as_concept_id	<<llecumn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<llecumn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	rlecumn	[interger option]	Right lower extremity upper motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	rleumnclinind	Right lower extremity upper motor neuron clinical indicator	observation_source_value	Right lower extremity upper motor neuron clinical indicator		value_as_concept_id	<<rlecumn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<rlecumn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	blbclmn	[interger option]	Bulbar lower motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	2000000029	Bulbar lower motor neuron clinical indicator	observation_source_value	Bulbar lower motor neuron clinical indicator		value_as_concept_id	<<blbclmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<blbclmn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	lueclmn	[interger option]	Left upper extremity lower motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	luelmnclinind	Left upper extremity lower motor neuron clinical indicator	observation_source_value	Left upper extremity lower motor neuron clinical indicator		value_as_concept_id	<<lueclmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<lueclmn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	rueclmn	[interger option]	Right upper extremity lower motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	ruelmnclinind	Right upper extremity lower motor neuron clinical indicator	observation_source_value	Right upper extremity lower motor neuron clinical indicator		value_as_concept_id	<<rueclmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<rueclmn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	trnkclmn	[interger option]	Trunk lower motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	trunklmnclinind	Trunk lower motor neuron clinical indicator	observation_source_value	Trunk lower motor neuron clinical indicator		value_as_concept_id	<<trnkclmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<trnkclmn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	lleclmn	[interger option]	Left lower extremity lower motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	llelmnclinind	Left lower extremity lower motor neuron clinical indicator	observation_source_value	Left lower extremity lower motor neuron clinical indicator		value_as_concept_id	<<lleclmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<lleclmn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	rleclmn	[interger option]	Right lower extremity lower motor neuron clinical indicator	alsdxdt	[relative day]											observation_concept_id	rlelmnclinind	Right lower extremity lower motor neuron clinical indicator	observation_source_value	Right lower extremity lower motor neuron clinical indicator		value_as_concept_id	<<rleclmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<rleclmn>>	Yes, No, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	blbelmn	[interger option]	Bulbar lower motor neuron electromyogram indicator	alsdxdt	[relative day]											observation_concept_id	2000000030	Bulbar lower motor neuron electromyogram indicator	observation_source_value	Bulbar lower motor neuron electromyogram indicator		value_as_concept_id	<<blbelmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<blbelmn>>	Denervation, No Denervation, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	lueelmn	[interger option]	Left upper extremity lower motor neuron electromyogram indicator	alsdxdt	[relative day]											observation_concept_id	luelmnemgind	Left upper extremity lower motor neuron electromyogram indicator	observation_source_value	Left upper extremity lower motor neuron electromyogram indicator		value_as_concept_id	<<lueelmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<lueelmn>>	Denervation, No Denervation, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	rueelmn	[interger option]	Right upper extremity lower motor neuron electromyogram indicator	alsdxdt	[relative day]											observation_concept_id	ruelmnemgind	Right upper extremity lower motor neuron electromyogram indicator	observation_source_value	Right upper extremity lower motor neuron electromyogram indicator		value_as_concept_id	<<rueelmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<rueelmn>>	Denervation, No Denervation, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	trnkelmn	[interger option]	Trunk lower motor neuron electromyogram indicator	alsdxdt	[relative day]											observation_concept_id	trunklmnemgind	Trunk lower motor neuron electromyogram indicator	observation_source_value	Trunk lower motor neuron electromyogram indicator		value_as_concept_id	<<trnkelmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<trnkelmn>>	Denervation, No Denervation, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	lleelmn	[interger option]	Left lower extremity lower motor neuron electromyogram indicator	alsdxdt	[relative day]											observation_concept_id	llelmnemgind	Left lower extremity lower motor neuron electromyogram indicator	observation_source_value	Left lower extremity lower motor neuron electromyogram indicator		value_as_concept_id	<<lleelmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<lleelmn>>	Denervation, No Denervation, Not Done	observation_date	{alsdxdt}								
	AALSDXFX	rleelmn	[interger option]	Right lower extremity lower motor neuron electromyogram indicator	alsdxdt	[relative day]											observation_concept_id	rlelmnemgind	Right lower extremity lower motor neuron electromyogram indicator	observation_source_value	Right lower extremity lower motor neuron electromyogram indicator		value_as_concept_id	<<rleelmn>>	yes (45877994), no (45878245), not assessed (45881531)	value_source_value	<<rleelmn>>	Denervation, No Denervation, Not Done	observation_date	{alsdxdt}								