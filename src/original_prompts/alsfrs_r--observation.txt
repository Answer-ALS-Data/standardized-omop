I want to turn the input table into an OMOP table with the indicated fields. 
The name of the script will be <source_table>--<target_table>.py in lowercase
Include a logging file
The source_table is the name of the table in source_tables, but with .csv at the end.
The target table is the first part of the sheet name in caps, it should be saved the same as the script as .csv in lowercase, in the omop_tables folder
[] indicates data type, where [relative days] is days since the initial visit, and [integer option] is an integer that represents certain string values.
<> indicates putting the value of the variable directly into the final table
<<>> indicates using the value of the variable as an input to some function (named <source_table>_<source_variable>_to_<target_table>_<target_variable>) to fill the target table. 
	In most cases, this function is as simple as converting from the integer option to the corresponding _meaning column value. Notice that the source_meaning (often corresponding to _source_value) and target_meaning (often corrsponding to _concept_name) might be different
	In others it is using a relative day and index date to create a new date (index + relative_day). 
	There may be other functions that require some reasoning from context in the sheet to define
<<<>>> indicates using another sheet to fill the values for this source-target pair
/ alone indicates empty on purpose, and that it applies to all entries in the target table
A target_value with no brackets indicates to enter the literal text shown
Any _concept_id should have a corresponding _concept_name next to it corresponding to it's textual meaning (usually in it's target_meaning_ column)
if by the end, a target row have no concept_id it should be filled with code 0 with name No Matching Concept


Here is table can you create the ETL code for this? I would like this general logic to apply to any other set of source-target tables:

use: from helpers import relative_day_to_date, check_missing_concept_ids, get_visit_occurrence_id

Final column order: person_id	observation_concept_id	observation_concept_name	observation_source_value	observation_date	observation_type_concept_id	value_as_number	value_as_string	value_as_concept_id	value_as_concept_name	value_source_value	qualifier_concept_id	qualifier_concept_name	qualifier_source_value	unit_concept_id	unit_concept_name	unit_source_value	visit_occurrence_id	observation_event_id	obs_event_field_concept_id
person_id = <Participant_ID>
observation_start_date = relative_day_to_date(<alsfrsdt>, index_date)
_type = 32851  (this is Healthcare professional filled survey)
if value, qualifier, unit (concept id/name) not used then leave these blank. value source should show for example for 4 "Marked drooling; requires constant tissue or handkerchief". obseervation source just show the question wording without the variable

ALSFRS_R-observation
source_table	source_variable_1	source_value_1	source_meaning_1	source_variable_2	source_value_2	source_meaning_2	source_variable_3	source_value_3	source_meaning_3	source_variable_4	source_value_4	source_meaning_4	source_variable_5	source_value_5	source_meaning_5	target_variable_1	target_value_1	target_meaning_1	target_variable_2	target_value_2	target_meaning_2	target_variable_3	target_value_3	target_meaning_3	target_variable_4	target_value_4	target_meaning_4	target_variable_5	target_value_5	target_meaning_5	target_variable_6	target_value_6	target_meaning_6	target_variable_7	target_value_7	target_meaning_7
ALSFRS_R	alsfrs1	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529071	Speech [ALSFRS-R]	observation_source_value	alsfrs1; Speech		value_as_number	<alsfrs1>		value_source_value	<alsfrs1>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs2	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529072	Salivation [ALSFRS-R]	observation_source_value	alsfrs2; Salivation		value_as_number	<alsfrs2>		value_source_value	<alsfrs2>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs3	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529073	Swallowing [ALSFRS-R]	observation_source_value	alsfrs3; Swallowing		value_as_number	<alsfrs3>		value_source_value	<alsfrs3>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs4	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529074	Handwriting [ALSFRS-R]	observation_source_value	alsfrs4; Handwriting		value_as_number	<alsfrs4>		value_source_value	<alsfrs4>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs5a	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529075	Cutting food and handling utensils (patients without gastrostomy) [ALSFRS-R]	observation_source_value	alsfrs5a; Cutting Food and Handling Utensils (patients without gastrostomy)		value_as_number	<alsfrs5a>		value_source_value	<alsfrs5a>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs5b	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529076	Cutting food and handling utensils (patients with gastrostomy) [ALSFRS-R]	observation_source_value	alsfrs5b; Cutting Food and Handling Utensils (alternate scale for patients with gastrostomy)		value_as_number	<alsfrs5b>		value_source_value	<alsfrs5b>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs6	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529077	Dressing and hygiene [ALSFRS-R]	observation_source_value	alsfrs6; Dressing and Hygiene		value_as_number	<alsfrs6>		value_source_value	<alsfrs6>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs7	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529078	Turning in bed and adjusting bed clothes [ALSFRS-R]	observation_source_value	alsfrs7; Turning in Bed and Adjusting Bed Clothes		value_as_number	<alsfrs7>		value_source_value	<alsfrs7>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs8	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529079	Walking [ALSFRS-R]	observation_source_value	alsfrs8; Walking		value_as_number	<alsfrs8>		value_source_value	<alsfrs8>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrs9	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529080	Climbing stairs [ALSFRS-R]	observation_source_value	alsfrs9; Climbing Stairs		value_as_number	<alsfrs9>		value_source_value	<alsfrs9>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrsr1	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529081	Dyspnea [ALSFRS-R]	observation_source_value	alsfrsr1; Dyspnea		value_as_number	<alsfrsr1>		value_source_value	<alsfrsr1>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrsr2	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529082	Orthopnea [ALSFRS-R]	observation_source_value	alsfrsr2; Orthopnea 		value_as_number	<alsfrsr2>		value_source_value	<alsfrsr2>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrsr3	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529083	Respiratory insufficiency [ALSFRS-R]	observation_source_value	alsfrsr3; Respiratory Insufficiency		value_as_number	<alsfrsr3>		value_source_value	<alsfrsr3>		observation_date	{Visit_Date}							
ALSFRS_R	alsfrst	[interger option]		Visit_Date	[relative day]											observation_concept_id	42529084	Total score [ALSFRS-R]	observation_source_value	alsfrst; Total		value_as_number	<alsfrst>		value_source_value	<alsfrst>		observation_date	{Visit_Date}							

Conversion Table (source values)
Score	4	3	2	1	0
Speech [alsfrs1]	Normal speech processes	Detectable speech disturbances	Intelligible with repeating	Speech combined with nonvocal communication	Loss of useful speech
Salivation [alsfrs2]	Normal	Slight but definite excess of saliva in mouth; may have nighttime drooling	Moderately excessive saliva; may have minimal drooling	Marked excess of saliva with some drooling	Marked drooling; requires constant tissue or handkerchief
Swallowing [alsfrs3]	Normal eating habits	Early eating problems – occasional choking	Dietary consistency changes	Needs supplemental tube feeding	NPO (exclusively parenteral or enteral feeding)
Handwriting [alsfrs4]	Normal	Slow or sloppy; all words are legible	Not all words are legible	Able to grip pen but unable to write	Unable to grip pen
Subject has a gastrostomy [alsfrs5]	–	–	–	Yes (1)	No (2)
5a. Cutting Food (no gastrostomy) [alsfrs5a]	Normal	Somewhat slow and clumsy, but no help needed	Can cut most foods, although clumsy and slow; some help needed	Food must be cut by someone, but can still feed slowly	Needs to be fed
5b. Cutting Food (gastrostomy) [alsfrs5b]	Normal	Clumsy but able to perform all manipulations independently	Some help needed with closures and fasteners	Provides minimal assistance to caregivers	Unable to perform any aspect of task
Dressing and Hygiene [alsfrs6]	Normal function	Independent and complete self-care with effort or decreased efficiency	Intermittent assistance or substitute methods	Needs attendant for self-care	Total dependence
Turning in Bed [alsfrs7]	Normal	Somewhat slow and clumsy, but no help needed	Can turn alone or adjust sheets, but with great difficulty	Can initiate, but not turn or adjust sheets alone	Helpless
Walking [alsfrs8]	Normal	Early ambulation difficulties	Walks with assistance	Nonambulatory functional movement only	No purposeful leg movement
Climbing Stairs [alsfrs9]	Normal	Slow	Mild unsteadiness or fatigue	Needs assistance	Cannot do
R-1 Dyspnea [alsfrsr1]	None	Occurs when walking	Occurs with one or more of: eating, bathing, dressing	Occurs at rest, difficulty breathing when either sitting or lying	Significant difficulty, considering mechanical respiratory support
R-2 Orthopnea [alsfrsr2]	None	Some difficulty sleeping due to shortness of breath, not using more than 2 pillows	Needs extra pillows (>2) to sleep	Can only sleep sitting up	Unable to sleep without mechanical assistance
R-3 Respiratory Insufficiency [alsfrsr3]	None	Intermittent use of NIPPV	Continuous use of NIPPV at night	Continuous use of NIPPV day and night	Invasive mechanical ventilation (intubation/tracheostomy)


qualifier_concept_id	qualifier_concept_name unit_concept_id	unit_concept_name