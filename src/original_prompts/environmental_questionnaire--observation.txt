
I want to turn the input table into an OMOP table with the indicated fields. 
The name of the script will be <source_table>--<target_table>.py in lowercase
Include a logging file
The source_table is the name of the table in source_tables, but with .csv at the end.
The target table is the first part of the sheet name in caps, it should be saved the same as the script as .csv in lowercase, in the omop_tables folder
[] indicates data type, where [relative days] is days since the initial visit, and [integer option] is an integer that represents certain string values.
<> indicates putting the value of the variable directly into the final table
<<>> indicates using the value of the variable as an input to some function (named <source_table>_<source_variable>_to_<target_table>_<target_variable>) to fill the target table. 
	In most cases, this function is as simple as converting from the integer option to the corresponding _meaning column value. Notice that the source_meaning (often corresponding to _source_value) and target_meaning (often corrsponding to _concept_name) might be different
	In others it is using a relative day and index date to create a new date (index + relative_day). 
	There may be other functions that require some reasoning from context in the sheet to define
<<<>>> indicates using another sheet to fill the values for this source-target pair
/ alone indicates empty on purpose, and that it applies to all entries in the target table
A target_value with no brackets indicates to enter the literal text shown
Any _concept_id should have a corresponding _concept_name next to it corresponding to it's textual meaning (usually in it's target_meaning_ column)
if by the end, a target row have no concept_id it should be filled with code 0 with name No Matching Concept

Here is table can you create the ETL code for this? I would like this general logic to apply to any other set of source-target tables:

use: from helpers import relative_day_to_date, check_missing_concept_ids, get_visit_occurrence_id

Final column order: person_id	observation_concept_id	observation_concept_name	observation_source_value	observation_date	observation_type_concept_id	value_as_number	value_as_string	value_as_concept_id	value_as_concept_name	value_source_value	qualifier_concept_id	qualifier_concept_name	qualifier_source_value	unit_concept_id	unit_concept_name	unit_source_value	visit_occurrence_id	observation_event_id	obs_event_field_concept_id
person_id = <Participant_ID>
observation_start_date = relative_day_to_date(<Visit_Date>, index_date)
_type = 32851  (this is Healthcare professional filled survey)
if value, qualifier, unit (concept id/name) not used then leave these blank.

Environmental_Questionnaire-observation
	Environmental_Questionnaire	mock	[interger option]	Management Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36310392	Management Occupations	value_source_value	Management Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	bfopo	[interger option]	Business and Financial Operations Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36308234	Business and Financial Operations Occupations	value_source_value	Business and Financial Operations Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	cmock	[interger option]	Computer and Mathematical Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36309431	Computer and Mathematical Occupations	value_source_value	Computer and Mathematical Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	aeock	[interger option]	Architecture and Engineering Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36311194	Architecture and Engineering Occupations	value_source_value	Architecture and Engineering Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	lpssock	[interger option]	Life, Physical, and Social Science Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36308008	Life, Physical, and Social Science Occupations	value_source_value	Life, Physical, and Social Science Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	cssock	[interger option]	Community and Social Service Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36308579	Community and Social Service Occupations	value_source_value	Community and Social Service Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	lock	[interger option]	Legal Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36307876	Legal Occupations	value_source_value	Legal Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	etlock	[interger option]	Education, Training, and Library Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36310455	Education, Training, and Library Occupations	value_source_value	Education, Training, and Library Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	adesmock	[interger option]	Arts, Design, Entertainment, Sports, and Media Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36309675	Arts, Design, Entertainment, Sports, and Media Occupations	value_source_value	Arts, Design, Entertainment, Sports, and Media Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	hptock	[interger option]	Healthcare Practitioners and Technical Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36308137	Healthcare Practitioners and Technical Occupations	value_source_value	Healthcare Practitioners and Technical Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	hsock	[interger option]	Healthcare Support Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36307824	Healthcare Support Occupations	value_source_value	Healthcare Support Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	psock	[interger option]	Protective Service Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36309614	Protective Service Occupations	value_source_value	Protective Service Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	fpsrock	[interger option]	Food Preparation and Serving Related Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36307878	Food Preparation and Serving Related Occupations	value_source_value	Food Preparation and Serving Related Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	bgclmock	[interger option]	Building and Grounds Cleaning and Maintenance Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36310459	Building and Grounds Cleaning and Maintenance Occupations	value_source_value	Building and Grounds Cleaning and Maintenance Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	pcsock	[interger option]	Personal Care and Service Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36309317	Personal Care and Service Occupations	value_source_value	Personal Care and Service Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	srock	[interger option]	Sales and Related Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36310875	Sales and Related Occupations	value_source_value	Sales and Related Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	oasock	[interger option]	Office and Administrative Support Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36307554	Office and Administrative Support Occupations	value_source_value	Office and Administrative Support Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	fffock	[interger option]	Farming, Fishing, and Forestry Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36307977	Farming, Fishing, and Forestry Occupations	value_source_value	Farming, Fishing, and Forestry Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	ceock	[interger option]	Construction and Extraction Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36307566	Construction and Extraction Occupations	value_source_value	Construction and Extraction Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	imrock	[interger option]	Installation, Maintenance, and Repair Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36308876	Installation, Maintenance, and Repair Occupations	value_source_value	Installation, Maintenance, and Repair Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	pock	[interger option]	Production Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36310607	Production Occupations	value_source_value	Production Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	tmmock	[interger option]	Transportation and Material Moving Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36309959	Transportation and Material Moving Occupations	value_source_value	Transportation and Material Moving Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	msock	[interger option]	Military Specific Occupations	Visit_Date	[relative day]											observation_concept_id	44786930	Occupation [NTDS]	observation_source_value	Which of the following occupations have you had for at least 1 year? (check all that apply)		value_as_concept_id	36309362	Military Specific Occupations	value_source_value	Military Specific Occupations		observation_date	{Visit_Date}								
	Environmental_Questionnaire	exerdd	[number]	Prior to your symptom onset, how many days per week do you exercise at least moderately (break a sweat)? 	Visit_Date	[relative day]											observation_concept_id	4036426	Frequency of exercise	observation_source_value	Prior to your symptom onset, how many days per week do you exercise at least moderately (break a sweat)? 		value_as_number	<exerdd>		value_source_value	<exerdd>		unit_concept_id	4036426	day per week	unit_source_value	days per week		observation_date	{Visit_Date}		
	Environmental_Questionnaire	milirb	[interger option]	Were you in the military?	outusrb	[interger option]		yrsout	[text]		where	[text]		Visit_Date	[relative day]		observation_concept_id	37162399	Military service finding	observation_source_value	Were you in the military?		value_as_concept_id	<<milirb>>	yes (45877994), no (45878245)	value_source_value	Were you in the military?: <<milirb>>; Were you deployed outside the US? <<outusrb>>; If so, what years? <yrsout>; To where? <where>	Yes, No 										
	Environmental_Questionnaire	yrstb	[number]	How many years were you in the military?	Visit_Date	[relative day]											observation_concept_id	4073594	Duration of military service	observation_source_value	How many years were you in the military?		value_as_number	<yrstb>		value_source_value	<yrstb>		unit_concept_id	9448	year	unit_source_value	years		observation_date	{Visit_Date}		
	Environmental_Questionnaire	headrb	[interger option]	Yes, No	edrb	[interger option]	Yes, No										observation_concept_id	1340204	History of event	observation_source_value	Head injury (more than one year prior to symptom onset)		value_as_concept_id	375415	Injury of head	value_source_value	Have you ever been admitted to the hospital for a head injury?: <<headrb>>;  Have you ever been seen in the ED for a head injury?: <<edrb>>		observation_date	{Visit_Date}								
	Environmental_Questionnaire	concussrb	[interger option]	Yes, No	concusstb	[number]											observation_concept_id	1340204	History of event	observation_source_value	Have you had any concussions? 		value_as_concept_id	4001336	Concussion injury of brain	value_source_value	Have you had any concussions?: <<concussrb>>; If so, how many? : <<concusstb>>		observation_date	{Visit_Date}								
	Environmental_Questionnaire	smokerb	[interger option]														observation_concept_id	3012697	History of Tobacco use	observation_source_value	Have you ever been a smoker? 		value_as_concept_id	<<smokerb>>	yes (45877994), no (45878245)	value_source_value	Have you ever been a smoker?: <<smokerb>>	Yes, No 	observation_date	{Visit_Date}								
	Environmental_Questionnaire	yrssmktb	[number]		smkavgtb	[number]											observation_concept_id	903650	Cigarettes pack-years smoked during life	observation_source_value	How many years were you a smoker? How many packs per day (on average)?		value_as_number	{yrssmktb * smkavgtb * 365}		value_source_value	How many years were you a smoker?: <<yrssmktb>>; How many packs per day (on average)?: <<smkavgtb>>		observation_date	{Visit_Date}								
	Environmental_Questionnaire	driavgtb	[number]														observation_concept_id	3043872	Alcoholic drinks per week - Reported	observation_source_value	"In the 10 years prior to your diagnosis, approximately how much alcohol did you drink (on average)?"		value_as_number	<driavgtb>		value_source_value	<<driavgtb>> drinks per week		observation_date	{Visit_Date}								