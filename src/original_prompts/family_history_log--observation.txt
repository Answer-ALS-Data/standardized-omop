
I want to turn the input table into an OMOP table with the indicated fields. 
The name of the script will be <source_table>--<target_table>.py in lowercase
Include a logging file
The source_table is the name of the table in source_tables, but with .csv at the end.
The target table is the first part of the sheet name in caps, it should be saved the same as the script as .csv in lowercase, in the omop_tables folder
[] indicates data type, where [relative days] is days since the initial visit, and [integer option] is an integer that represents certain string values.
<> indicates putting the value of the variable directly into the final table
<<>> indicates using the value of the variable as an input to some function (named <source_table>_<source_variable>_to_<target_table>_<target_variable>) to fill the target table. 
	In most cases, this function is as simple as converting from the integer option to the corresponding _meaning column value. Notice that the source_meaning (often corresponding to _source_value) and target_meaning (often corrsponding to _concept_name) might be different
	In others it is using a relative day and index date to create a new date (index + relative_day). 
	There may be other functions that require some reasoning from context in the sheet to define
<<<>>> indicates using another sheet to fill the values for this source-target pair
/ alone indicates empty on purpose, and that it applies to all entries in the target table
A target_value with no brackets indicates to enter the literal text shown
Any _concept_id should have a corresponding _concept_name next to it corresponding to it's textual meaning (usually in it's target_meaning_ column)
if by the end, a target row have no concept_id it should be filled with code 0 with name No Matching Concept

Here is table can you create the ETL code for this? I would like this general logic to apply to any other set of source-target tables:

use: from helpers import relative_day_to_date, check_missing_concept_ids, get_visit_occurrence_id

Final column order: person_id	observation_concept_id	observation_concept_name	observation_source_value	observation_date	observation_type_concept_id	value_as_number	value_as_string	value_as_concept_id	value_as_concept_name	value_source_value	qualifier_concept_id	qualifier_concept_name	qualifier_source_value	unit_concept_id	unit_concept_name	unit_source_value	visit_occurrence_id	observation_event_id	obs_event_field_concept_id
person_id = <Participant_ID>
observation_start_date = relative_day_to_date(<Visit_Date>, index_date)
_type = 32851  (this is Healthcare professional filled survey)
if value, qualifier, unit (concept id/name) not used then leave these blank.

family_history_log-observation
target_row_group	source_table	source_variable_1	source_value_1	source_meaning_1	source_variable_2	source_value_2	source_meaning_2	source_variable_3	source_value_3	source_meaning_3	source_variable_4	source_value_4	source_meaning_4	source_variable_5	source_value_5	source_meaning_5	target_variable_1	target_value_1	target_meaning_1	target_variable_2	target_value_2	target_meaning_2	target_variable_3	target_value_3	target_meaning_3	target_variable_4	target_value_4	target_meaning_4	target_variable_5	target_value_5	target_meaning_5	target_variable_6	target_value_6	target_meaning_6	target_variable_7	target_value_7	target_meaning_7	Notes
	Family_History_Log	famrel	[interger option]		famher	[interger option]											observation_concept_id	various		observation_source_value	relative: <famrel> | heredity: <famher>		value_as_concept_id	various		value_source_value	various		observation_date	{Visit_Date}								


The observation concept comes from this translation of variables from Family_History.csv. source concept will be relative: <famrel> | heredity: <famher>

famrel	famher	Concept Meaning	Concept ID
Mother		Family history with explicit context pertaining to mother	4051255
Father		Family history with explicit context pertaining to father	4051256
Sister		Family history with explicit context pertaining to sister	4051258
Brother		"FH: Brother
"	4051262
Half-sister		Family history with explicit context pertaining to sister	4051258
Half-brother		"FH: Brother
"	4051262
Daughter		Family history with explicit context pertaining to daughter	4054433
Son		Family history with explicit context pertaining to son	4052795
Grandmother	Paternal	Family history with explicit context pertaining to paternal grandmother	4052802
Grandmother	Maternal	FH: Maternal grandmother	4050942
Grandfather	Paternal	Family history with explicit context pertaining to paternal grandfather	4052801
Grandfather	Maternal	Family history with explicit context pertaining to maternal grandfather	4052800
Aunt		Family history with explicit context pertaining to aunt	4050943
Uncle		Family history with explicit context pertaining to uncle	4051265
Cousin		Family history with explicit context pertaining to cousin	713135

Here is how it looks in the survey:
Relative [famrel]

  [1]  Mother
  [2]  Father
  [3]  Sister
  [4]  Brother
  [5]  Half-sister
  [6]  Half-brother
  [7]  Daughter
  [8]  Son
  [9]  Grandmother
[10]  Grandfather
[11]  Aunt
[12]  Uncle
[13]  Cousin
[99]  Other relative [famrelsp] [TEXT]

Heredity [famher]		[1]  Paternal		[2]  Maternal


The value as concept id and name come from these variables for diseases. source value will be condition: <<Variable>> | other: <<Free Text Variable>>

Source Condition	Concept Name	Concept ID	Variable	Free Text Variable
Alzheimer’s Disease	Alzheimer's disease	378419	fhalz	
Amyotrophic Lateral Sclerosis	Amyotrophic lateral sclerosis	373182	fhals	
Dementia	Dementia	4182210	fhdem	
Down’s Syndrome	Anomaly of chromosome pair 21	4320803	fhdown	
Frontotemporal Dementia	Frontotemporal dementia	4043378	fhftd	
Huntington’s Disease	Huntington's chorea	374341	fhhd	
Parkinson’s Disease	Parkinson's disease	381270	fhpd	
Psychiatric Disorder	Psychiatric disorder	36308213	fhpsy	fhpsysp
Arthritis	Arthritis	4291025	fharth	
Asthma	Asthma	317009	fhasth	
Cancer	Malignant neoplastic disease	443392	fhcanc	
Circulation Problems	Vascular disorder	443784	fhcirc	
Diabetes	Diabetes mellitus	201820	fhdiab	
Heart Disease	Heart disease	321588	fhhrt	
High Blood Pressure	Hypertensive disorder	316866	fhhbp	
Lung Disease	Disorder of respiratory system	320136	fhlung	
Stroke	Cerebrovascular accident	381316	fhstk	
Other Disease			fhot	fhotsp

And these for genes. source value will be condition: <<Variable>> | other: <<Free Text Variable>>:

Gene	Concept Meaning	Concept ID	Variable	Free Text Variable
ANG	ANG (angiogenin) gene variant measurement	35961859	fhgnang	
C90RF72	C9orf72 (C9orf72-SMCR8 complex subunit) gene variant measurement	35954626	fhgnc9	
FUS	FUS gene rearrangement measurement	19643404	fhgnfus	
Progranulin	GRN (granulin precursor) gene variant measurement	35951629	fhgnprg	
SETX	SETX (senataxin) gene variant measurement	35958907	fhgnsetx	
SOD1	SOD1 (superoxide dismutase 1) gene variant measurement	35948140	fhgnsod1	
TAU	MAPT (microtubule associated protein tau) gene variant measurement	35946715	fhgntau	
TDP-43	TARDBP (TAR DNA binding protein) gene variant measurement	35964178	fhgntdp	
VAPB	VAPB (VAMP associated protein B and C) gene variant measurement	35956055	fhgnvapb	
VCP	VCP (valosin containing protein) gene variant measurement	35958302	fhgnvcp	
Other: Profilin-1	PFN1 (profilin 1) gene variant measurement	35949229	fhgnot	fhgnotsp


