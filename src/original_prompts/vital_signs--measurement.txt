

I want to turn the input table into an OMOP table with the indicated fields. 
The name of the script will be <source_table>--<target_table>.py in lowercase
Include a logging file
The source_table is the name of the table in source_tables, but with .csv at the end.
The target table is the first part of the sheet name in caps, it should be saved the same as the script as .csv in lowercase, in the omop_tables folder
[] indicates data type, where [relative days] is days since the initial visit, and [integer option] is an integer that represents certain string values.
<> indicates putting the value of the variable directly into the final table
<<>> indicates using the value of the variable as an input to some function (named <source_table>_<source_variable>_to_<target_table>_<target_variable>) to fill the target table. 
	In most cases, this function is as simple as converting from the integer option to the corresponding _meaning column value. Notice that the source_meaning (often corresponding to _source_value) and target_meaning (often corrsponding to _concept_name) might be different
	In others it is using a relative day and index date to create a new date (index + relative_day). 
	There may be other functions that require some reasoning from context in the sheet to define
<<<>>> indicates using another sheet to fill the values for this source-target pair
/ alone indicates empty on purpose, and that it applies to all entries in the target table
A target_value with no brackets indicates to enter the literal text shown
Any _concept_id should have a corresponding _concept_name next to it corresponding to it's textual meaning (usually in it's target_meaning_ column)
if by the end, a target row have no concept_id it should be filled with code 0 with name No Matching Concept

Here is table can you create the ETL code for this? I would like this general logic to apply to any other set of source-target tables:

use: from helpers import relative_day_to_date, check_missing_concept_ids, get_visit_occurrence_id

Final column order: person_id	measurement_concept_id	measurement_concept_name	measurement_source_value	measurement_date	measurement_type_concept_id	value_as_number	value_as_concept_id	value_as_concept_name	value_source_value	unit_concept_id	unit_concept_name	unit_source_value	visit_occurrence_id
person_id = <Participant_ID>
measurement_start_date = relative_day_to_date(<labdt>, index_date)
_type = 32851  (this is Healthcare professional filled survey)
if value, unit (concept id/name) not used then leave these blank.


Vital_Signs-measurement
target_row_group	source_table	source_variable_1	source_value_1	source_meaning_1	source_variable_2	source_value_2	source_meaning_2	source_variable_3	source_value_3	source_meaning_3	source_variable_4	source_value_4	source_meaning_4	target_variable_1	target_value_1	target_meaning_1	target_variable_2	target_value_2	target_meaning_2	target_variable_3	target_value_3	target_meaning_3	target_variable_4	target_value_4	target_meaning_4	target_variable_5	target_value_5	target_meaning_5	target_variable_6	target_value_6	target_meaning_6	target_variable_7	target_value_7	target_meaning_7	target_variable_8	target_value_8	target_meaning_8	target_variable_9	target_value_9	target_meaning_9	Notes
16	Vital_Signs	temp	[number]		temprt	[interger option]	Axillary	tempu	[interger option]	F or C	vsdt	[relative day]		measurement_concept_id	4188706	Axillary temperature	value_as_number	<temp>		unit_concept_id	<<tempu>>	degree Fahrenheit (9289) or degree Celsius (586323)	measurement_source_value	Axillary Temperature		value_source_value	<temp>		unit_source_value	<tempu>		measurement_date	<<vsdt>>								
17	Vital_Signs	temp	[number]		temprt	[interger option]	Oral	tempu	[interger option]	F or C	vsdt	[relative day]		measurement_concept_id	3006322	Oral temperature	value_as_number	<temp>		unit_concept_id	<<tempu>>	degree Fahrenheit (9289) or degree Celsius (586323)	measurement_source_value	Oral Temperature		value_source_value	<temp>		unit_source_value	<tempu>		measurement_date	<<vsdt>>								
18	Vital_Signs	temp	[number]		temprt	[interger option]	Rectal	tempu	[interger option]	F or C	vsdt	[relative day]		measurement_concept_id	3022060	Rectal temperature	value_as_number	<temp>		unit_concept_id	<<tempu>>	degree Fahrenheit (9289) or degree Celsius (586323)	measurement_source_value	Rectal Temperature		value_source_value	<temp>		unit_source_value	<tempu>		measurement_date	<<vsdt>>								
19	Vital_Signs	temp	[number]		temprt	[interger option]	Tympanic	tempu	[interger option]	F or C	vsdt	[relative day]		measurement_concept_id	4215364	Tympanic temperature	value_as_number	<temp>		unit_concept_id	<<tempu>>	degree Fahrenheit (9289) or degree Celsius (586323)	measurement_source_value	Tympanic Temperature		value_source_value	<temp>		unit_source_value	<tempu>		measurement_date	<<vsdt>>								
20	Vital_Signs	temp	[number]		temprtsp	[text]	Temporal	tempu	[interger option]	F or C	vsdt	[relative day]		measurement_concept_id	46235152	Body temperature - Temporal artery	value_as_number	<temp>		unit_concept_id	<<tempu>>	degree Fahrenheit (9289) or degree Celsius (586323)	measurement_source_value	<temprt>		value_source_value	<temp>		unit_source_value	<tempu>		measurement_date	<<vsdt>>								
21	Vital_Signs	bpsys	[number]	Systolic blood pressure	bppos	[interger option]	Standing, Sitting, or Supine							measurement_concept_id	4152194	Systolic blood pressure	value_as_number	<bpsys>		unit_concept_id	37546954	mmHg	measurement_source_value	Systolic Blood Pressure		value_source_value	<bpsys> | <<bppos>> (1: Standing, 2: Sitting, or 3: Supine)		unit_source_value	mmHG		measurement_date	<<vsdt>>		value_as_concept_id	<<bppos>>	"Standing blood pressure (4060833), Sitting blood pressure (4060834), or Lying blood pressure (4060832)
"				
22	Vital_Signs	bpdias	[number]	Diastolic blood pressure	bppos	[interger option]	Standing, Sitting, or Supine							measurement_concept_id	4154790	Diastolic blood pressure	value_as_number	<bpsys>		unit_concept_id	37546954	mmHg	measurement_source_value	Diastolic Blood Pressure		value_source_value	<bpdias> | <<bppos>> (1: Standing, 2: Sitting, or 3: Supine)		unit_source_value	mmHG		measurement_date	<<vsdt>>		value_as_concept_id	<<bppos>>	"Standing blood pressure (4060833), Sitting blood pressure (4060834), or Lying blood pressure (4060832)
"				
23	Vital_Signs	hr	[number]	Heart rate										measurement_concept_id	3027018	Heart rate	value_as_number	<hr>		unit_concept_id	4118124	beats/min	measurement_source_value	Heart rate		value_source_value	<hr>		unit_source_value	Beats / min		measurement_date	<<vsdt>>								
24	Vital_Signs	rr	[number]	Respiratory Rate										measurement_concept_id	4313591	Respiratory rate	value_as_number	<rr>		unit_concept_id	4117833	breaths/min	measurement_source_value	Respiratory Rate		value_source_value	<rr>		unit_source_value	Breaths / min		measurement_date	<<vsdt>>								
25	Vital_Signs	weight	[number]	Weight	weightu	[interger option]	lb, kg							measurement_concept_id	3025315	Body weight	value_as_number	<weight>		unit_concept_id	<<weightu>>	"pound (US) (8739), or kilogram (9529)
"	measurement_source_value	Weight		value_source_value	<weight>		unit_source_value	<weightu>		measurement_date	<<vsdt>>								
26	Vital_Signs	height	[number]	Height	heightu	[interger option]	in, cm							measurement_concept_id	3036277	Body height	value_as_number	<height>		unit_concept_id	<<heightu>>	"inch (US) (9330), or centimeter (8582)
"	measurement_source_value	Height		value_source_value	<height>		unit_source_value	<heightu>		measurement_date	<<vsdt>>								
27	Vital_Signs	bmi	[number]	BMI										measurement_concept_id	3038553	Body mass index (BMI) [Ratio]	value_as_number	<bmi>		unit_concept_id	8523	ratio	measurement_source_value	BMI		value_source_value	<bmi>		unit_source_value	BMI		measurement_date	<<vsdt>>								